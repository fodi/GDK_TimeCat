{
	"name": "aCannon  ðŸ˜ˆ",
	"events": [
		{
			"aceType": "action",
			"aceName": "spawnAll",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Spawn a number of cannons according to level rules"
				}
			],
			"sid": 799452279524543,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "repeat",
							"objectClass": "System",
							"sid": 968358049106647,
							"parameters": {
								"count": "Functions.Rules_getNumber(PARAM_Cannon_Count_Init)"
							}
						}
					],
					"actions": [
						{
							"customAction": "spawn",
							"objectClass": "Cannon",
							"sid": 221999060392936
						}
					],
					"sid": 296294398056226
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "spawn",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Spawn one cannon at a random position around the level if there aren't too many cannons yet"
				},
				{
					"type": "comment",
					"text": "todo make sure cannons don't spawn on top of / too near each other"
				}
			],
			"sid": 435920396597194,
			"children": [
				{
					"eventType": "variable",
					"name": "cannonCount",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 747314110742028
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-all",
							"objectClass": "System",
							"sid": 559544847403718,
							"parameters": {
								"object": "Cannon"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 970669870398454,
							"parameters": {
								"instance-variable": "health",
								"comparison": 4,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 232041345314384,
							"parameters": {
								"variable": "cannonCount",
								"value": "Cannon.PickedCount"
							}
						}
					],
					"sid": 988071772823657
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 698108850538855,
							"parameters": {
								"variable": "cannonCount",
								"comparison": 2,
								"value": "Functions.Rules_getNumber(PARAM_Cannon_Count_Max)"
							}
						}
					],
					"actions": [
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 573811177175989,
							"parameters": {
								"object-to-create": "Cannon",
								"layer": "LAYER_Main",
								"x": "midX",
								"y": "midY",
								"create-hierarchy": true,
								"template-name": "\"\""
							}
						},
						{
							"id": "set-visible",
							"objectClass": "Cannon",
							"sid": 694796100320004,
							"parameters": {
								"visibility": "invisible"
							}
						},
						{
							"type": "comment",
							"text": "Initialize a cannon"
						},
						{
							"callFunction": "playSoundAt",
							"sid": 463299931045027,
							"parameters": [
								"Cannon.X",
								"Cannon.Y",
								"SFX_Cannon_Spawn",
								"1",
								"NO"
							]
						},
						{
							"type": "comment",
							"text": "Override parameters if needed"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 702279349945873,
							"parameters": {
								"instance-variable": "R_Projectile_MovementSpeed",
								"value": "Functions.Rules_getNumber(PARAM_Projectile_Speed)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 990105390265364,
							"parameters": {
								"instance-variable": "R_Projectile_MovementSpeed_Increase",
								"value": "Functions.Rules_getNumber(PARAM_Projectile_Speed_Increase)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 613927019985307,
							"parameters": {
								"instance-variable": "R_Projectile_MovementSpeed_Max",
								"value": "Functions.Rules_getNumber(PARAM_Projectile_Speed_Max)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 383233945582705,
							"parameters": {
								"instance-variable": "R_Shoot_Interval_Min",
								"value": "Functions.Rules_getNumber(PARAM_Projectile_SpawnTime_Min)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 525652846033371,
							"parameters": {
								"instance-variable": "R_Shoot_Interval_Max",
								"value": "Functions.Rules_getNumber(PARAM_Projectile_SpawnTime_Max)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 110547362980877,
							"parameters": {
								"instance-variable": "R_Health_Max",
								"value": "Functions.Rules_getNumber(PARAM_Cannon_Health)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 231453873915548,
							"parameters": {
								"instance-variable": "R_Acceleration",
								"value": "Functions.Rules_getNumber(PARAM_Cannon_Acceleration)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 601690867573247,
							"parameters": {
								"instance-variable": "R_Speed_Max",
								"value": "Functions.Rules_getNumber(PARAM_Cannon_SpeedMax)"
							}
						},
						{
							"type": "comment",
							"text": "Initialize cannon"
						},
						{
							"id": "set-z-elevation",
							"objectClass": "Cannon",
							"sid": 855527980277589,
							"parameters": {
								"z": "Basemap.ZElevation + 1"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 281512154902897,
							"parameters": {
								"instance-variable": "health",
								"value": "Self.R_Health_Max"
							}
						},
						{
							"id": "set-target",
							"objectClass": "Cannon",
							"sid": 548754900860994,
							"behaviorType": "Orbit",
							"parameters": {
								"x": "midX",
								"y": "midY"
							}
						},
						{
							"id": "set-rotation",
							"objectClass": "Cannon",
							"sid": 623460859352761,
							"behaviorType": "Orbit",
							"parameters": {
								"angle": "random(0, 360)"
							}
						},
						{
							"id": "set-radius",
							"objectClass": "Cannon",
							"sid": 498447914942479,
							"behaviorType": "Orbit",
							"parameters": {
								"primary": "distance(0, 0, midX, midY) + C_Level_Tile_Size",
								"secondary": "distance(0, 0, midX, midY) + C_Level_Tile_Size"
							}
						},
						{
							"id": "set-angle-toward-position",
							"objectClass": "Cannon",
							"sid": 395140256709513,
							"parameters": {
								"x": "midX",
								"y": "midY"
							}
						}
					],
					"sid": 151165711030697,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-children",
									"objectClass": "Cannon",
									"sid": 806792520270387,
									"parameters": {
										"child": "3dCannon",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"id": "set-face-object",
									"objectClass": "3dCannon",
									"sid": 312025342287590,
									"parameters": {
										"face": "right",
										"object": "txCannonIdle"
									}
								},
								{
									"id": "set-z-elevation",
									"objectClass": "3dCannon",
									"sid": 526828482078493,
									"parameters": {
										"z": "Basemap.ZElevation -Self.ZHeight - 1"
									}
								},
								{
									"id": "set-opacity",
									"objectClass": "Cannon",
									"sid": 694170027360656,
									"parameters": {
										"opacity": "0"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Cannon",
									"sid": 385383076265118,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "TWEEN_Cannon_Opacity_Appear",
										"property": "offsetOpacity",
										"end-value": "100",
										"time": "C_Cannon_Tween_Time_Appear",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								},
								{
									"id": "set-default-color",
									"objectClass": "Cannon",
									"sid": 413399719161185,
									"parameters": {
										"color": "rgbEx(0, 0, 0)"
									}
								},
								{
									"id": "tween-one-property",
									"objectClass": "Cannon",
									"sid": 386999575888181,
									"behaviorType": "Tween",
									"parameters": {
										"tags": "TWEEN_Cannon_Color_Appear",
										"property": "offsetColor",
										"end-value": "rgbEx(100, 100, 100)",
										"time": "C_Cannon_Tween_Time_Appear",
										"ease": "default",
										"destroy-on-complete": "no",
										"loop": "no",
										"ping-pong": "no",
										"repeat-count": "1"
									}
								}
							],
							"sid": 189233420045399
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"type": "comment",
									"text": "this is an yucky workaround because the cannon spawns in the middle of the level and the orbit behaviour doesn't immediately reposition it"
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 979331382614448,
									"parameters": {
										"seconds": "dt * 2",
										"use-timescale": true
									}
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Cannon",
									"sid": 921688856275679,
									"parameters": {
										"instance-variable": "isInitialized",
										"value": "YES"
									}
								},
								{
									"id": "set-visible",
									"objectClass": "Cannon",
									"sid": 581672308249083,
									"parameters": {
										"visibility": "visible"
									}
								}
							],
							"sid": 562111437314413
						}
					]
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "selectTarget",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Target the nearest non-dead player"
				}
			],
			"sid": 131260329623665,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Player",
							"sid": 989117274216236,
							"parameters": {
								"instance-variable": "isDead",
								"comparison": 0,
								"value": "NO"
							}
						},
						{
							"id": "pick-nearestfurthest",
							"objectClass": "Player",
							"sid": 492415219486085,
							"parameters": {
								"which": "nearest",
								"x": "Cannon.X",
								"y": "Cannon.Y"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 830571715829877,
							"parameters": {
								"instance-variable": "targetPlayerId",
								"value": "Player.playerId"
							}
						}
					],
					"sid": 678812993783150
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "else",
							"objectClass": "System",
							"sid": 163523841496399
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Cannon",
							"sid": 622829968178242,
							"parameters": {
								"instance-variable": "targetPlayerId",
								"value": "NOTHING"
							}
						}
					],
					"sid": 381067891100985
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "tick",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Update cannon \"look\" angle towards its target or the center of the level as a fallback"
				}
			],
			"sid": 761034600587050,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 619499824376016,
							"parameters": {
								"instance-variable": "isInitialized",
								"comparison": 0,
								"value": "YES"
							}
						}
					],
					"actions": [],
					"sid": 355396723561282,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "Player",
									"sid": 937202320495370,
									"parameters": {
										"instance-variable": "playerId",
										"comparison": 0,
										"value": "Cannon.targetPlayerId"
									}
								}
							],
							"actions": [],
							"sid": 658240828157026,
							"children": [
								{
									"eventType": "comment",
									"text": "Look directly at player if within X degrees"
								},
								{
									"eventType": "comment",
									"text": "todo mn or just look directly at selected player and only lerp while switching targets"
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "is-within-angle",
											"objectClass": "Cannon",
											"sid": 702633982711541,
											"parameters": {
												"within": "3",
												"angle": "angle(Self.X, Self.Y, Player.X, Player.Y)"
											}
										}
									],
									"actions": [
										{
											"id": "set-angle",
											"objectClass": "Cannon",
											"sid": 240215662633031,
											"parameters": {
												"angle": "angle(Self.X, Self.Y, Player.X, Player.Y)"
											}
										}
									],
									"sid": 253804009265206
								},
								{
									"eventType": "comment",
									"text": "Lerp angle toward player"
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 570150117872616
										}
									],
									"actions": [
										{
											"id": "set-angle",
											"objectClass": "Cannon",
											"sid": 119966305788335,
											"parameters": {
												"angle": "anglelerp(Self.Angle, angle(Self.X, Self.Y, Player.X, Player.Y), 1 - C_Cannon_TargetRotationLerpFactor ^ dt)"
											}
										}
									],
									"sid": 354202783094584
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 281064007591271
								}
							],
							"actions": [
								{
									"id": "set-angle",
									"objectClass": "Cannon",
									"sid": 892586921617854,
									"parameters": {
										"angle": "anglelerp(Self.Angle, angle(Self.X, Self.Y, midX, midY), 1 - C_Cannon_TargetRotationLerpFactor ^ dt)"
									}
								}
							],
							"sid": 573089056638156
						}
					]
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "attack",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Start attack sequence (mouth opening animation, shooting projectile) & select new target"
				}
			],
			"sid": 173883774634553,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 296224590657464,
							"parameters": {
								"instance-variable": "isDead",
								"comparison": 0,
								"value": "NO"
							}
						}
					],
					"actions": [],
					"sid": 486795245449338,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-eventvar",
									"objectClass": "System",
									"sid": 383675333662858,
									"parameters": {
										"variable": "hasLevelEnded",
										"comparison": 0,
										"value": "NO"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "Player",
									"sid": 356481813027379,
									"parameters": {
										"instance-variable": "playerId",
										"comparison": 0,
										"value": "Cannon.targetPlayerId"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "Player",
									"sid": 468046070506771,
									"parameters": {
										"instance-variable": "isDead",
										"comparison": 0,
										"value": "NO"
									}
								},
								{
									"id": "pick-children",
									"objectClass": "Cannon",
									"sid": 445287173877104,
									"parameters": {
										"child": "3dCannon",
										"which": "own"
									}
								}
							],
							"actions": [
								{
									"type": "comment",
									"text": "Switch to attack animation"
								},
								{
									"id": "set-face-object",
									"objectClass": "3dCannon",
									"sid": 205575227541889,
									"parameters": {
										"face": "right",
										"object": "txCannonAttacking"
									}
								},
								{
									"id": "start-animation",
									"objectClass": "txCannonAttacking",
									"sid": 637814941452373,
									"parameters": {
										"from": "beginning"
									}
								},
								{
									"type": "comment",
									"text": "Wait until the attack animation's end"
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 383160912062471,
									"parameters": {
										"seconds": "(txCannonAttacking.AnimationFrameCount + 1) / txCannonAttacking.AnimationSpeed",
										"use-timescale": true
									}
								},
								{
									"type": "comment",
									"text": "Shoot projectile"
								},
								{
									"customAction": "spawn",
									"objectClass": "Projectile",
									"sid": 425722420684544,
									"parameters": [
										"Cannon.X",
										"Cannon.Y",
										"Cannon.R_Projectile_MovementSpeed",
										"Cannon.Angle"
									]
								},
								{
									"callFunction": "playSoundAt",
									"sid": 714898918960901,
									"parameters": [
										"Cannon.X",
										"Cannon.Y",
										"SFX_Cannon_Fire",
										"4",
										"NO"
									]
								},
								{
									"type": "comment",
									"text": "Increase next projectile movement speed rule"
								},
								{
									"id": "set-instvar-value",
									"objectClass": "Cannon",
									"sid": 911567787981592,
									"parameters": {
										"instance-variable": "R_Projectile_MovementSpeed",
										"value": "min(Self.R_Projectile_MovementSpeed + Self.R_Projectile_MovementSpeed_Increase, Self.R_Projectile_MovementSpeed_Max)"
									}
								},
								{
									"type": "comment",
									"text": "Wait for a bit, then switch back to idle animation & choose new target"
								},
								{
									"id": "wait",
									"objectClass": "System",
									"sid": 743682954139422,
									"parameters": {
										"seconds": "5 / txCannonAttacking.AnimationSpeed",
										"use-timescale": true
									}
								},
								{
									"id": "set-face-object",
									"objectClass": "3dCannon",
									"sid": 885091260209424,
									"parameters": {
										"face": "right",
										"object": "txCannonIdle"
									}
								}
							],
							"sid": 531736139187097
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 873518004865674
								}
							],
							"actions": [
								{
									"id": "log",
									"objectClass": "Browser",
									"sid": 435508653439587,
									"parameters": {
										"type": "log",
										"message": "StringSub(\"Cannon #{0} has no target, skipping attack.\", Cannon.UID)"
									}
								}
							],
							"sid": 106535116374594
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"customAction": "selectTarget",
									"objectClass": "Cannon",
									"sid": 769177701460970
								}
							],
							"sid": 653240863348037
						}
					]
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "startMoving",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Start moving (after emerging from the water) and start periodic speed checks"
				}
			],
			"sid": 502112530341107,
			"children": [
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-acceleration",
							"objectClass": "Cannon",
							"sid": 772188775822377,
							"behaviorType": "Orbit",
							"parameters": {
								"acceleration": "Self.R_Acceleration"
							}
						},
						{
							"id": "start-timer",
							"objectClass": "Cannon",
							"sid": 507838794012651,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "0.1",
								"type": "regular",
								"tag": "TIMER_Cannon_Checkup"
							}
						}
					],
					"sid": 470010014893638
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "startAttackTimer",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Queue timer for next attack"
				}
			],
			"sid": 472290367645562,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 883593618929358,
							"parameters": {
								"variable": "hasLevelEnded",
								"comparison": 0,
								"value": "NO"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 576496749911701,
							"parameters": {
								"instance-variable": "isDead",
								"comparison": 0,
								"value": "NO"
							}
						}
					],
					"actions": [
						{
							"id": "start-timer",
							"objectClass": "Cannon",
							"sid": 597017978541607,
							"behaviorType": "Timer",
							"parameters": {
								"duration": "random(Self.R_Shoot_Interval_Min, Self.R_Shoot_Interval_Max)",
								"type": "once",
								"tag": "TIMER_Cannon_Attack"
							}
						}
					],
					"sid": 524467050311132
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "changeHealth",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "amount",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 275319688986470
				},
				{
					"name": "knockbackAngle",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 637936370343844
				},
				{
					"name": "knockbackAmount",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 335063323408719
				}
			],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Damage (or heal) cannon"
				}
			],
			"sid": 724590973381787,
			"children": [
				{
					"eventType": "comment",
					"text": "If cannon is not dead yet..."
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 250507311822637,
							"parameters": {
								"instance-variable": "isDead",
								"comparison": 0,
								"value": "NO"
							}
						}
					],
					"actions": [],
					"sid": 590641527380385,
					"children": [
						{
							"eventType": "comment",
							"text": "Change health by requested amount"
						},
						{
							"eventType": "block",
							"conditions": [],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Cannon",
									"sid": 173333760347100,
									"parameters": {
										"instance-variable": "health",
										"value": "clamp(Self.health + amount, 0, Self.R_Health_Max)"
									}
								}
							],
							"sid": 124313305352208
						},
						{
							"eventType": "comment",
							"text": "If cannon is out of health, kill it"
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "Cannon",
									"sid": 932175974496760,
									"parameters": {
										"instance-variable": "health",
										"comparison": 0,
										"value": "0"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "Cannon",
									"sid": 329211521123719,
									"parameters": {
										"instance-variable": "isDead",
										"value": "YES"
									}
								},
								{
									"id": "stop-timer",
									"objectClass": "Cannon",
									"sid": 452152464039220,
									"behaviorType": "Timer",
									"parameters": {
										"tag": "TIMER_Cannon_Attack"
									}
								},
								{
									"id": "set-speed",
									"objectClass": "Cannon",
									"sid": 556502961226939,
									"behaviorType": "Orbit",
									"parameters": {
										"speed": "0"
									}
								},
								{
									"id": "set-enabled",
									"objectClass": "Cannon",
									"sid": 874022222277865,
									"behaviorType": "Orbit",
									"parameters": {
										"state": "disabled"
									}
								},
								{
									"callFunction": "playSoundAt",
									"sid": 257252964152082,
									"parameters": [
										"Cannon.X",
										"Cannon.Y",
										"SFX_Cannon_Destroyed",
										"4",
										"NO"
									]
								}
							],
							"sid": 225619912471130,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "pick-children",
											"objectClass": "Cannon",
											"sid": 574543526891365,
											"parameters": {
												"child": "3dCannon",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "tween-one-property",
											"objectClass": "3dCannon",
											"sid": 215818211483978,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "TWEEN_3dCannon_ZElevation_Disappear",
												"property": "offsetZElevation",
												"end-value": "Basemap.ZElevation - (Self.ZHeight * 5)",
												"time": "1",
												"ease": "easeinback",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										}
									],
									"sid": 515455460940898,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-eventvar",
													"objectClass": "System",
													"sid": 286154809289190,
													"parameters": {
														"variable": "knockbackAmount",
														"comparison": 4,
														"value": "0"
													}
												}
											],
											"actions": [
												{
													"customAction": "spawnParticles",
													"objectClass": "Cannon",
													"sid": 402276959391357,
													"parameters": [
														"int(random(3, 5))",
														"knockbackAngle",
														"120"
													]
												},
												{
													"id": "tween-two-properties",
													"objectClass": "Cannon",
													"sid": 662027707338997,
													"behaviorType": "Tween",
													"parameters": {
														"tags": "TWEEN_Cannon_Position_Disappear",
														"property": "position",
														"end-x": "Self.X + cos(knockbackAngle) * knockbackAmount",
														"end-y": "Self.Y + sin(knockbackAngle) * knockbackAmount",
														"time": "1",
														"ease": "easeoutquint",
														"destroy-on-complete": "no",
														"loop": "no",
														"ping-pong": "no",
														"repeat-count": "1"
													}
												}
											],
											"sid": 685262354751770
										}
									]
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 801978891225529
								}
							],
							"actions": [],
							"sid": 311891977178462,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-eventvar",
											"objectClass": "System",
											"sid": 484842828182707,
											"parameters": {
												"variable": "amount",
												"comparison": 2,
												"value": "0"
											}
										},
										{
											"id": "pick-children",
											"objectClass": "Cannon",
											"sid": 948678602234297,
											"parameters": {
												"child": "3dCannon",
												"which": "own"
											}
										}
									],
									"actions": [
										{
											"id": "stop-tweens",
											"objectClass": "3dCannon",
											"sid": 614938580153911,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "TWEEN_3dCannon_Color"
											}
										},
										{
											"id": "set-default-color",
											"objectClass": "3dCannon",
											"sid": 479813506753253,
											"parameters": {
												"color": "rgbEx(100, 0, 0)"
											}
										},
										{
											"id": "tween-one-property",
											"objectClass": "3dCannon",
											"sid": 980588010733394,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "TWEEN_3dCannon_Color",
												"property": "offsetColor",
												"end-value": "rgbEx(100, 100, 100)",
												"time": "1",
												"ease": "easeoutcubic",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"callFunction": "playSoundAt",
											"sid": 687997336677025,
											"parameters": [
												"Cannon.X",
												"Cannon.Y",
												"SFX_Collision_Item_Cannon",
												"4",
												"NO"
											]
										}
									],
									"sid": 705791146425713
								}
							]
						}
					]
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "onHit",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "damageAmount",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 387806090442275
				},
				{
					"name": "knockbackAngle",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 139184670931786
				}
			],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "When a cannon is hit, stop & restart its movement & damage it"
				}
			],
			"sid": 816239261862657,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-instance-variable",
							"objectClass": "Cannon",
							"sid": 467817722650586,
							"parameters": {
								"instance-variable": "isDead",
								"comparison": 0,
								"value": "NO"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "todo_mn"
						},
						{
							"customAction": "changeHealth",
							"objectClass": "Cannon",
							"sid": 903873063038961,
							"parameters": [
								"-damageAmount",
								"knockbackAngle",
								"100"
							]
						},
						{
							"type": "comment",
							"text": "Stop & restart cannon movement"
						},
						{
							"id": "set-speed",
							"objectClass": "Cannon",
							"sid": 417676870683877,
							"behaviorType": "Orbit",
							"parameters": {
								"speed": "0"
							}
						},
						{
							"id": "set-acceleration",
							"objectClass": "Cannon",
							"sid": 121567118722999,
							"behaviorType": "Orbit",
							"parameters": {
								"acceleration": "0"
							}
						},
						{
							"customAction": "startMoving",
							"objectClass": "Cannon",
							"sid": 607212674698199
						}
					],
					"sid": 495382800259477
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "limitMaxSpeed",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Limit the speed of the cannon (runs periodically)"
				}
			],
			"sid": 866279655512816,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 319311198252082,
							"parameters": {
								"object": "Cannon",
								"expression": "Cannon.Orbit.Speed",
								"comparison": 5,
								"value": "Cannon.R_Speed_Max"
							}
						}
					],
					"actions": [
						{
							"id": "stop-timer",
							"objectClass": "Cannon",
							"sid": 477906759339590,
							"behaviorType": "Timer",
							"parameters": {
								"tag": "TIMER_Cannon_Checkup"
							}
						},
						{
							"id": "set-speed",
							"objectClass": "Cannon",
							"sid": 684388477907491,
							"behaviorType": "Orbit",
							"parameters": {
								"speed": "Self.R_Speed_Max"
							}
						},
						{
							"id": "set-acceleration",
							"objectClass": "Cannon",
							"sid": 159461102917086,
							"behaviorType": "Orbit",
							"parameters": {
								"acceleration": "0"
							}
						},
						{
							"id": "log",
							"objectClass": "Browser",
							"sid": 968238823839252,
							"disabled": true,
							"parameters": {
								"type": "log",
								"message": "\"Cannon #\" & Cannon.UID & \" reached max speed\""
							}
						}
					],
					"sid": 155281456437913
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "spawnParticles",
			"objectClass": "Cannon",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "count",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 441722118865964
				},
				{
					"name": "knockbackAngle",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 606588741625526
				},
				{
					"name": "particleConeAngle",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 165065839315670
				}
			],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"type": "comment",
					"text": "Spawn 3D stone particles from a cannon (when it dies)"
				}
			],
			"sid": 564820386427700,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "pick-children",
							"objectClass": "Cannon",
							"sid": 176269359835070,
							"parameters": {
								"child": "3dCannon",
								"which": "own"
							}
						}
					],
					"actions": [],
					"sid": 410744518415338,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "for",
									"objectClass": "System",
									"sid": 289833916992962,
									"parameters": {
										"name": "\"\"",
										"start-index": "0",
										"end-index": "count - 1"
									}
								}
							],
							"actions": [],
							"sid": 620020688903620,
							"children": [
								{
									"eventType": "variable",
									"name": "movementAngle",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 710182529983685
								},
								{
									"eventType": "variable",
									"name": "movementDistance",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 441282334610115
								},
								{
									"eventType": "variable",
									"name": "cubeSize",
									"type": "number",
									"initialValue": "0",
									"comment": "",
									"isStatic": false,
									"isConstant": false,
									"sid": 712759804411648
								},
								{
									"bookmark": true,
									"eventType": "block",
									"conditions": [],
									"actions": [
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 176355333394946,
											"parameters": {
												"variable": "movementAngle",
												"value": "knockbackAngle + 180 - (particleConeAngle* 0.5)+ loopindex * int(particleConeAngle / count)"
											}
										},
										{
											"type": "comment",
											"text": "todo particle speed / distance stuff based on knockback angle"
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 701650316271591,
											"parameters": {
												"variable": "movementDistance",
												"value": "random(120, 300)"
											}
										},
										{
											"id": "set-eventvar-value",
											"objectClass": "System",
											"sid": 568407042109063,
											"parameters": {
												"variable": "cubeSize",
												"value": "random(6, 12)"
											}
										},
										{
											"id": "create-object",
											"objectClass": "System",
											"sid": 876563805381645,
											"parameters": {
												"object-to-create": "3dStoneParticle",
												"layer": "3dCannon.LayerName",
												"x": "3dCannon.X",
												"y": "3dCannon.Y",
												"create-hierarchy": false,
												"template-name": "\"\""
											}
										},
										{
											"id": "set-size",
											"objectClass": "3dStoneParticle",
											"sid": 339713163692651,
											"parameters": {
												"width": "cubeSize",
												"height": "cubeSize"
											}
										},
										{
											"id": "set-z-height",
											"objectClass": "3dStoneParticle",
											"sid": 806032284888280,
											"parameters": {
												"z-height": "cubeSize"
											}
										},
										{
											"id": "log",
											"objectClass": "Browser",
											"sid": 985048262902852,
											"parameters": {
												"type": "log",
												"message": "\"movement angle: \" & movementAngle"
											}
										},
										{
											"id": "set-angle",
											"objectClass": "3dStoneParticle",
											"sid": 440090371609641,
											"parameters": {
												"angle": "random(0, 360)"
											}
										},
										{
											"id": "set-z-elevation",
											"objectClass": "3dStoneParticle",
											"sid": 245245344581351,
											"parameters": {
												"z": "3dCannon.ZElevation + (3dCannon.ZHeight * 0.5) - (Self.ZHeight * 0.5)"
											}
										},
										{
											"id": "tween-two-properties",
											"objectClass": "3dStoneParticle",
											"sid": 274257854278195,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"\"",
												"property": "position",
												"end-x": "Self.X + cos(movementAngle) * movementDistance",
												"end-y": "Self.Y + sin(movementAngle) * movementDistance",
												"time": "2",
												"ease": "easeoutquad",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"id": "tween-one-property",
											"objectClass": "3dStoneParticle",
											"sid": 464946692463566,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"\"",
												"property": "offsetOpacity",
												"end-value": "0",
												"time": "1",
												"ease": "easeinexpo",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"id": "tween-one-property",
											"objectClass": "3dStoneParticle",
											"sid": 259018119315599,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"\"",
												"property": "offsetZElevation",
												"end-value": "Basemap.ZElevation - random(100, 200)",
												"time": "1",
												"ease": "easeinoutback",
												"destroy-on-complete": "yes",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										},
										{
											"id": "tween-one-property",
											"objectClass": "3dStoneParticle",
											"sid": 225547757720729,
											"behaviorType": "Tween",
											"parameters": {
												"tags": "\"\"",
												"property": "offsetAngle",
												"end-value": "Self.Angle + (random(100, 250) * choose(-1, 1))",
												"time": "2",
												"ease": "default",
												"destroy-on-complete": "no",
												"loop": "no",
												"ping-pong": "no",
												"repeat-count": "1"
											}
										}
									],
									"sid": 244020340638506
								}
							]
						}
					]
				}
			]
		}
	],
	"sid": 414515668687685
}